<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BMI Calculator ‚Äî SmallTools</title>
  <link rel="stylesheet" href="../../assets/style.css">
  <script>(function(){const t=localStorage.getItem('st-theme')||'light';document.documentElement.setAttribute('data-theme',t);})();</script>
  <style>
    .bmi-bar{height:18px;border-radius:999px;background:linear-gradient(to right,#3b82f6 0%,#22c55e 30%,#eab308 60%,#f97316 80%,#ef4444 100%);position:relative;margin:16px 0 6px}
    .bmi-needle{position:absolute;top:-6px;width:4px;height:30px;background:var(--text);border-radius:2px;transform:translateX(-50%);transition:left .4s}
    .bmi-zone-table{width:100%;border-collapse:collapse;margin-top:14px;font-size:13px}
    .bmi-zone-table th{text-align:left;padding:6px 10px;border-bottom:2px solid var(--border);color:var(--text-2);font-size:11px;text-transform:uppercase}
    .bmi-zone-table td{padding:6px 10px;border-bottom:1px solid var(--border)}
    .bmi-zone-table tr.active-row td{font-weight:700}
    .zone-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;vertical-align:middle}
    .info-note{font-size:12px;color:var(--text-2);margin-top:10px;padding:10px;background:var(--surface-2,var(--bg));border-radius:7px;border:1px solid var(--border)}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;padding:10px 20px">
      <a href="../../index.html" class="logo logo-sm">Small<span>Tools</span></a>
      <button class="theme-toggle" id="themeToggle">üåô</button>
    </div>
  </header>
  <main class="tool-page">
    <div class="breadcrumb"><a href="../../index.html">Home</a> / Math / BMI Calculator</div>
    <div class="tool-header">
      <h1>‚öñÔ∏è BMI Calculator</h1>
      <p>Calculate Body Mass Index, healthy weight range, and waist-to-height ratio.</p>
    </div>
    <div class="card">
      <div style="display:flex;gap:10px;margin-bottom:14px">
        <button id="metricBtn" class="btn btn-primary" onclick="setSystem('metric')">Metric (kg/cm)</button>
        <button id="imperialBtn" class="btn btn-ghost" onclick="setSystem('imperial')">Imperial (lb/ft+in)</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div class="form-row" style="margin:0"><label id="wLabel">Weight (kg)</label><input type="number" id="weight" placeholder="70" oninput="calc()"></div>
        <div id="heightWrap" class="form-row" style="margin:0">
          <label id="hLabel">Height (cm)</label>
          <input type="number" id="height" placeholder="170" oninput="calc()">
        </div>
      </div>
      <div id="imperialHeight" style="display:none;margin-top:8px">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="form-row" style="margin:0"><label>Feet</label><input type="number" id="feet" placeholder="5" min="0" max="9" oninput="calc()"></div>
          <div class="form-row" style="margin:0"><label>Inches</label><input type="number" id="inches" placeholder="9" min="0" max="11" oninput="calc()"></div>
        </div>
      </div>
      <div class="form-row" style="margin-top:12px">
        <label id="waistLabel">Waist Circumference (cm) <span style="font-weight:400;color:var(--text-2);font-size:11px">optional</span></label>
        <input type="number" id="waist" placeholder="Optional ‚Äî for waist-to-height ratio" oninput="calc()">
      </div>

      <div class="result-row" id="resultRow" style="display:none;flex-direction:column;align-items:flex-start;gap:4px">
        <div style="display:flex;justify-content:space-between;width:100%;flex-wrap:wrap;gap:12px">
          <div><div class="result-label">Your BMI</div><div class="result-value" id="bmiVal">‚Äî</div></div>
          <div><div class="result-label">Category</div><div id="bmiCat" style="font-size:16px;font-weight:700;margin-top:4px"></div></div>
          <div id="whtrBox" style="display:none"><div class="result-label">Waist-to-Height Ratio</div><div id="whtrVal" style="font-size:16px;font-weight:700;margin-top:4px"></div></div>
          <div><div class="result-label">Healthy Weight Range</div><div id="healthyRange" style="font-size:14px;font-weight:600;margin-top:4px;color:var(--primary)"></div></div>
        </div>
        <div style="width:100%;margin-top:8px">
          <div class="bmi-bar"><div class="bmi-needle" id="needle"></div></div>
          <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--text-2)"><span>Underweight</span><span>Normal</span><span>Overweight</span><span>Obese</span></div>
        </div>
      </div>

      <table class="bmi-zone-table" id="zoneTable" style="display:none">
        <thead><tr><th>Category</th><th>BMI Range</th><th>Status</th></tr></thead>
        <tbody>
          <tr data-zone="under"><td><span class="zone-dot" style="background:#3b82f6"></span>Underweight</td><td>&lt; 18.5</td><td id="z0"></td></tr>
          <tr data-zone="normal"><td><span class="zone-dot" style="background:#22c55e"></span>Normal weight</td><td>18.5 ‚Äì 24.9</td><td id="z1"></td></tr>
          <tr data-zone="over"><td><span class="zone-dot" style="background:#eab308"></span>Overweight</td><td>25 ‚Äì 29.9</td><td id="z2"></td></tr>
          <tr data-zone="obese"><td><span class="zone-dot" style="background:#ef4444"></span>Obese</td><td>‚â• 30</td><td id="z3"></td></tr>
        </tbody>
      </table>

      <div class="info-note" id="infoNote" style="display:none">
        BMI is a screening tool, not a diagnostic. It doesn't account for muscle mass, bone density, or fat distribution. Athletes may show "overweight" BMI despite being healthy. Consult a healthcare provider for personalized guidance.
      </div>
    </div>
  </main>
  <footer class="site-footer"><div class="container">Your data never leaves your browser</div></footer>
  <script src="../../assets/common.js"></script>
  <script>
    let sys = loadPref('bmi-sys', 'metric');

    function setSystem(s) {
      sys = s;
      savePref('bmi-sys', s);
      document.getElementById('metricBtn').className = 'btn ' + (s==='metric' ? 'btn-primary' : 'btn-ghost');
      document.getElementById('imperialBtn').className = 'btn ' + (s==='imperial' ? 'btn-primary' : 'btn-ghost');
      document.getElementById('wLabel').textContent = 'Weight ' + (s==='metric' ? '(kg)' : '(lb)');
      const hWrap = document.getElementById('heightWrap');
      const impH = document.getElementById('imperialHeight');
      if (s === 'imperial') {
        hWrap.style.display = 'none';
        impH.style.display = '';
        document.getElementById('waistLabel').firstChild.textContent = 'Waist Circumference (in) ';
      } else {
        hWrap.style.display = '';
        impH.style.display = 'none';
        document.getElementById('waistLabel').firstChild.textContent = 'Waist Circumference (cm) ';
      }
      calc();
    }

    function calc() {
      let w = parseFloat(document.getElementById('weight').value);
      let h;
      if (sys === 'imperial') {
        const ft = parseFloat(document.getElementById('feet').value) || 0;
        const inc = parseFloat(document.getElementById('inches').value) || 0;
        const totalIn = ft * 12 + inc;
        h = totalIn * 2.54;
        if (w) w = w * 0.453592;
      } else {
        h = parseFloat(document.getElementById('height').value);
      }

      if (isNaN(w) || isNaN(h) || w <= 0 || h <= 0) {
        document.getElementById('resultRow').style.display = 'none';
        document.getElementById('zoneTable').style.display = 'none';
        document.getElementById('infoNote').style.display = 'none';
        return;
      }

      const bmi = w / ((h/100)**2);
      document.getElementById('resultRow').style.display = 'flex';
      document.getElementById('zoneTable').style.display = '';
      document.getElementById('infoNote').style.display = '';
      document.getElementById('bmiVal').textContent = bmi.toFixed(1);

      const cats = [
        {label:'Underweight', color:'#3b82f6', max:18.5, zone:'under'},
        {label:'Normal weight', color:'#22c55e', max:25, zone:'normal'},
        {label:'Overweight', color:'#eab308', max:30, zone:'over'},
        {label:'Obese', color:'#ef4444', max:Infinity, zone:'obese'}
      ];
      const cat = cats.find(c => bmi < c.max) || cats[3];
      document.getElementById('bmiCat').textContent = cat.label;
      document.getElementById('bmiCat').style.color = cat.color;

      // Healthy weight range for their height
      const hm = h / 100;
      const loKg = 18.5 * hm * hm;
      const hiKg = 24.9 * hm * hm;
      if (sys === 'imperial') {
        const loLb = (loKg / 0.453592).toFixed(0);
        const hiLb = (hiKg / 0.453592).toFixed(0);
        document.getElementById('healthyRange').textContent = loLb + ' ‚Äì ' + hiLb + ' lb';
      } else {
        document.getElementById('healthyRange').textContent = loKg.toFixed(1) + ' ‚Äì ' + hiKg.toFixed(1) + ' kg';
      }

      // Needle
      const pct = Math.min(100, Math.max(0, (bmi - 10) / 40 * 100));
      document.getElementById('needle').style.left = pct + '%';

      // Zone table
      const zones = ['under','normal','over','obese'];
      zones.forEach((z, i) => {
        const row = document.querySelector(`[data-zone="${z}"]`);
        row.classList.toggle('active-row', z === cat.zone);
        document.getElementById('z'+i).textContent = z === cat.zone ? '‚Üê You' : '';
      });

      // Waist-to-height ratio
      const waistRaw = parseFloat(document.getElementById('waist').value);
      const whtrBox = document.getElementById('whtrBox');
      if (!isNaN(waistRaw) && waistRaw > 0) {
        const waistCm = sys === 'imperial' ? waistRaw * 2.54 : waistRaw;
        const ratio = waistCm / h;
        const whtrLabel = ratio < 0.4 ? 'Underweight' : ratio < 0.5 ? 'Healthy' : ratio < 0.6 ? 'Overweight' : 'Very High Risk';
        const whtrColor = ratio < 0.4 ? '#3b82f6' : ratio < 0.5 ? '#22c55e' : ratio < 0.6 ? '#eab308' : '#ef4444';
        document.getElementById('whtrVal').textContent = ratio.toFixed(2) + ' ‚Äî ' + whtrLabel;
        document.getElementById('whtrVal').style.color = whtrColor;
        whtrBox.style.display = '';
      } else {
        whtrBox.style.display = 'none';
      }
    }

    setSystem(sys);
  </script>
</body>
</html>
